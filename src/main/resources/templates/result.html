<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Job Insights</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 min-h-screen flex items-center justify-center p-6">
    <div class="bg-white shadow-lg rounded-xl p-8 w-full max-w-3xl">
      <h1 class="text-2xl font-bold text-center mb-2">Job Insights</h1>
      <p class="text-center text-gray-600 mb-4" th:if="${role}">
        for <span th:text="${role}"></span>
      </p>

      <!-- Error Message -->
      <div th:if="${error}" class="text-red-600 mb-4" th:text="${error}"></div>

      <!-- Job Insights Section -->
      <div th:if="${jobInsights != null}">
        <div th:if="${jobInsights.jobTitles != null}">
          <h2 class="text-lg font-semibold text-blue-600">Job Titles</h2>
          <ul class="list-disc list-inside">
            <li th:each="t : ${jobInsights.jobTitles}" th:text="${t}"></li>
          </ul>
        </div>

        <div th:if="${jobInsights.skills != null}" class="mt-4">
          <h2 class="text-lg font-semibold text-green-600">Skills</h2>
          <ul class="list-disc list-inside">
            <li th:each="s : ${jobInsights.skills}" th:text="${s}"></li>
          </ul>
        </div>

        <div th:if="${jobInsights.certifications != null}" class="mt-4">
          <h2 class="text-lg font-semibold text-purple-600">Certifications</h2>
          <ul class="list-disc list-inside">
            <li th:each="c : ${jobInsights.certifications}" th:text="${c}"></li>
          </ul>
        </div>

        <div th:if="${jobInsights.education != null}" class="mt-4">
          <h2 class="text-lg font-semibold text-red-600">Education</h2>
          <ul class="list-disc list-inside">
            <li th:each="e : ${jobInsights.education}" th:text="${e}"></li>
          </ul>
        </div>
      </div>

      <!-- Job Match Score Section -->
      <div class="mt-6 bg-gray-50 p-4 rounded-xl shadow text-center">
        <h2 class="text-lg font-semibold text-gray-700 mb-4">
          Job Match Score
        </h2>

        <!-- Circular Progress Bar -->
        <div
          th:if="${jobScorePercentage != null}"
          class="flex flex-col items-center"
        >
          <div class="relative w-32 h-32">
            <svg class="w-32 h-32 transform -rotate-90">
              <circle
                cx="64"
                cy="64"
                r="54"
                stroke="currentColor"
                class="text-gray-200"
                stroke-width="12"
                fill="transparent"
              ></circle>
              <circle
                cx="64"
                cy="64"
                r="54"
                stroke="currentColor"
                class="text-green-500"
                stroke-width="12"
                fill="transparent"
                stroke-linecap="round"
                stroke-dasharray="339.292"
                th:attr="stroke-dashoffset=${339.292 - (jobScorePercentage * 339.292 / 100)}"
              ></circle>
            </svg>
            <div class="absolute inset-0 flex items-center justify-center">
              <span
                class="text-xl font-bold text-gray-700"
                th:text="${#numbers.formatDecimal(jobScorePercentage, 0, 0)} + '%'"
              ></span>
            </div>
          </div>
          <p class="mt-2 text-gray-600">
            <span class="font-bold text-green-600" th:text="${jobScore}"></span>
            matched
          </p>
        </div>

        <!-- Fallback if no resume uploaded -->
        <div th:if="${jobScorePercentage == null}" class="text-red-500">
          <span th:text="${jobScore}"></span>
        </div>
      </div>

      <!-- Back Button -->
      <div class="mt-6 text-center">
        <a href="/" class="bg-blue-500 text-white px-6 py-2 rounded-lg"
          >Go back</a
        >
      </div>
    </div>
  </body>
</html>
